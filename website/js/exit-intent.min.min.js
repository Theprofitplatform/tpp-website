export function initializeExitIntent() { let exitPopupShown = false; const exitPopup = document.getElementById('exitPopup'); const exitClose = document.getElementById('exitClose'); const exitDecline = document.getElementById('exitDecline'); if (!exitPopup || !exitClose || !exitDecline) { console.warn('Exit popup elements not found'); return; } document.addEventListener('mouseleave', function(e) { if (e.clientY <= 0 && !exitPopupShown && !localStorage.getItem('exitPopupShown')) { showExitPopup(); } }); setTimeout(() => { if (!exitPopupShown && !localStorage.getItem('exitPopupShown')) { showExitPopup(); } }, 60000); function showExitPopup() { if (exitPopupShown) return; exitPopupShown = true; exitPopup.classList.add('show'); document.body.style.overflow = 'hidden'; localStorage.setItem('exitPopupShown', 'true'); setTimeout(() => { hideExitPopup(); }, 30000); } function hideExitPopup() { exitPopup.classList.remove('show'); document.body.style.overflow = ''; } exitClose.addEventListener('click', hideExitPopup); exitDecline.addEventListener('click', hideExitPopup); const overlay = document.querySelector('.exit-popup-overlay'); if (overlay) { overlay.addEventListener('click', hideExitPopup); } document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && exitPopup.classList.contains('show')) { hideExitPopup(); } }); if (localStorage.getItem('exitPopupShown')) { setTimeout(() => { localStorage.removeItem('exitPopupShown'); }, 24 * 60 * 60 * 1000); } }